<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NutriMind AI ¬∑ Your Plan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        sans-serif;
      background: radial-gradient(circle at top left, #f9f7f2 0, #f3f2ed 38%, #eceae4 100%);
      color: #111111;
      line-height: 1.5;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    button {
      font-family: inherit;
    }

    .max-width {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* NAV ‚Äì same vibe as index/assessment */
    .nav {
      padding: 18px 0 6px;
      position: sticky;
      top: 0;
      z-index: 20;
      backdrop-filter: blur(16px);
      background: linear-gradient(to bottom, rgba(244,243,239,0.94), rgba(244,243,239,0.85), rgba(244,243,239,0));
    }

    .nav-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-logo-mark {
      width: 26px;
      height: 26px;
      border-radius: 9px;
      background: linear-gradient(135deg, #111111, #222222);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f9f7f2;
      font-size: 0.78rem;
      font-weight: 600;
    }

    .nav-logo-text {
      text-transform: uppercase;
      letter-spacing: 0.18em;
      font-size: 0.76rem;
      font-weight: 500;
      opacity: 0.85;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 18px;
      font-size: 0.88rem;
      opacity: 0.8;
    }

    .nav-links a {
      position: relative;
      padding-bottom: 2px;
    }

    .nav-links a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      height: 1px;
      width: 0;
      background: #111111;
      transition: width 0.2s ease-out;
    }

    .nav-links a:hover::after {
      width: 100%;
    }

    .nav-cta {
      padding: 7px 16px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.12);
      font-size: 0.85rem;
      background: rgba(255,255,255,0.9);
      cursor: pointer;
    }

    .nav-cta:hover {
      background: #111111;
      color: #f9f7f2;
      border-color: #111111;
    }

    /* PAGE SHELL */
    .page-shell {
      padding: 18px 0 40px;
    }

    .hero {
      padding: 12px 0 20px;
    }

    .hero-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 18px;
      align-items: center;
    }

    .hero-kicker {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.7;
      margin-bottom: 6px;
    }

    .hero-title {
      font-size: 1.7rem;
      letter-spacing: -0.02em;
      margin-bottom: 6px;
    }

    .hero-subtitle {
      font-size: 0.92rem;
      opacity: 0.8;
      max-width: 440px;
    }

    .hero-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }

    .hero-pill {
      border-radius: 999px;
      padding: 6px 10px;
      background: rgba(17,17,17,0.04);
      font-size: 0.75rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .hero-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #24a05a;
    }

    .hero-right-card {
      background: rgba(255,255,255,0.98);
      border-radius: 22px;
      padding: 14px 14px 14px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.08);
      border: 1px solid rgba(0,0,0,0.04);
    }

    .hero-right-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .hero-right-title {
      font-size: 0.9rem;
      font-weight: 500;
    }

    .hero-right-tag {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.6;
    }

    .hero-right-main {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 10px;
    }

    .hero-circle {
      width: 52px;
      height: 52px;
      border-radius: 999px;
      background: conic-gradient(from 210deg, #111111, #4e8f4d, #f5f3ee, #111111);
      padding: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero-circle-inner {
      width: 44px;
      height: 44px;
      border-radius: 999px;
      background: #f9f7f2;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      text-align: center;
      padding: 0 6px;
    }

    .hero-right-text {
      font-size: 0.8rem;
      opacity: 0.85;
    }

    .hero-right-buttons {
      display: flex;
      gap: 8px;
      margin-top: 6px;
      flex-wrap: wrap;
    }

    .btn-primary {
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      background: #111111;
      color: #f9f7f2;
      font-size: 0.82rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .btn-outline {
      padding: 7px 14px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.2);
      background: transparent;
      font-size: 0.8rem;
      cursor: pointer;
    }

    .btn-outline:hover {
      background: rgba(0,0,0,0.04);
    }

    /* MAIN GRID */
    .main-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 18px;
      align-items: flex-start;
    }

    .card {
      background: rgba(255,255,255,0.98);
      border-radius: 20px;
      padding: 14px 14px 14px;
      box-shadow: 0 18px 45px rgba(0,0,0,0.07);
      border: 1px solid rgba(0,0,0,0.04);
      margin-bottom: 14px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 0.95rem;
      font-weight: 500;
    }

    .card-tag {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.6;
    }

    .card-sub {
      font-size: 0.78rem;
      opacity: 0.7;
      margin-bottom: 10px;
    }

    /* METRIC ROWS */
    .metric-row {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .metric-chip {
      flex: 1 1 120px;
      padding: 8px 10px;
      border-radius: 12px;
      background: #f5f3ee;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .metric-label {
      font-size: 0.72rem;
      opacity: 0.7;
    }

    .metric-value {
      font-size: 0.9rem;
      font-weight: 500;
    }

    .metric-caption {
      font-size: 0.7rem;
      opacity: 0.7;
    }

    /* MEAL LIST */
    .meal-list {
      list-style: none;
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .meal-item {
      padding: 7px 0;
      border-bottom: 1px solid rgba(0,0,0,0.06);
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }

    .meal-item:last-child {
      border-bottom: none;
    }

    .meal-main {
      font-weight: 500;
    }

    .meal-detail {
      font-size: 0.76rem;
      opacity: 0.78;
    }

    .meal-kcal {
      font-size: 0.76rem;
      opacity: 0.75;
      white-space: nowrap;
    }

    /* TRAINING */
    .training-day {
      margin-bottom: 8px;
    }

    .training-day-title {
      font-size: 0.8rem;
      font-weight: 500;
    }

    .training-day-detail {
      font-size: 0.78rem;
      opacity: 0.78;
    }

    /* SIDE COLUMN LISTS */
    .profile-list {
      list-style: none;
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .profile-list li {
      padding: 4px 0;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .profile-list li:last-child {
      border-bottom: none;
    }

    .coach-note-text {
      font-size: 0.8rem;
      opacity: 0.84;
      margin-bottom: 6px;
    }

    .coach-note-highlight {
      font-size: 0.78rem;
      opacity: 0.8;
      padding: 7px 9px;
      border-radius: 10px;
      background: #f5f3ee;
      margin-top: 4px;
    }

    .mini-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      opacity: 0.6;
      margin-bottom: 3px;
    }

    .coming-soon {
      font-size: 0.76rem;
      opacity: 0.7;
      margin-top: 4px;
    }

    @media (max-width: 880px) {
      .hero-grid,
      .main-grid {
        grid-template-columns: 1fr;
      }

      .hero-right-card {
        order: 2;
      }
    }

    @media (max-width: 600px) {
      .hero-title {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <div class="max-width nav-inner">
      <div class="nav-left">
        <div class="nav-logo-mark">N</div>
        <div class="nav-logo-text">NutriMind AI</div>
      </div>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="assessment.html">Re-take assessment</a>
        <button class="nav-cta" type="button">Sign in</button>
      </div>
    </div>
  </header>

  <main class="page-shell">
    <div class="max-width">
      <!-- HERO -->
      <section class="hero">
        <div class="hero-grid">
          <div>
            <div class="hero-kicker">Your AI-built routine</div>
            <h1 class="hero-title" id="hero-title">
              Your first NutriMind blueprint is ready.
            </h1>
            <p class="hero-subtitle" id="hero-subtitle">
              This is your starting map for food, training, and recovery ‚Äî
              matched to your energy, schedule, and main goal. You‚Äôll be able
              to adjust pieces as you go.
            </p>

            <div class="hero-pills" id="hero-pills">
              <!-- filled by JS -->
            </div>
          </div>

          <aside class="hero-right-card">
            <div class="hero-right-header">
              <div>
                <div class="hero-right-tag">Today</div>
                <div class="hero-right-title">Read this like a coach‚Äôs text.</div>
              </div>
              <div style="font-size: 1rem;">‚ú®</div>
            </div>

            <div class="hero-right-main">
              <div class="hero-circle">
                <div class="hero-circle-inner" id="hero-circle-inner">
                  Dialed for you
                </div>
              </div>
              <div class="hero-right-text" id="hero-right-text">
                Stay within a calm, realistic structure this week. Hit your
                daily calories, keep protein high, and treat training days as
                ‚Äúnon-negotiables‚Äù ‚Äî not punishments.
              </div>
            </div>

            <div class="hero-right-buttons">
              <button class="btn-primary" type="button" id="btn-regenerate">
                ‚Üª Regenerate plan
              </button>
              <button class="btn-outline" type="button" id="btn-chat">
                üí¨ Chat with my coach
              </button>
            </div>
          </aside>
        </div>
      </section>

      <!-- MAIN GRID -->
      <section class="main-grid">
        <!-- LEFT: MAIN PLAN -->
        <div>
          <!-- DAILY OVERVIEW CARD -->
          <article class="card">
            <div class="card-header">
              <div>
                <div class="card-tag">Daily overview</div>
                <div class="card-title">Targets your coach is aiming for</div>
              </div>
              <div style="font-size: 0.78rem; opacity: 0.7;" id="card-overview-tag">
                Auto-calculated from your inputs
              </div>
            </div>
            <p class="card-sub">
              These are not rules ‚Äî they‚Äôre guardrails. If you land close most
              days, you‚Äôll move in the right direction.
            </p>

            <div class="metric-row">
              <div class="metric-chip">
                <div class="metric-label">Calories</div>
                <div class="metric-value" id="metric-calories">‚Äî kcal</div>
                <div class="metric-caption" id="metric-calories-caption">
                  Enough to support training & recovery
                </div>
              </div>
              <div class="metric-chip">
                <div class="metric-label">Protein</div>
                <div class="metric-value" id="metric-protein">‚Äî g</div>
                <div class="metric-caption">Spread across 3‚Äì4 meals</div>
              </div>
            </div>

            <div class="metric-row">
              <div class="metric-chip">
                <div class="metric-label">Carbs focus</div>
                <div class="metric-value" id="metric-carbs">‚Äî g</div>
                <div class="metric-caption">Clustered around training</div>
              </div>
              <div class="metric-chip">
                <div class="metric-label">Hydration</div>
                <div class="metric-value" id="metric-water">‚Äî L</div>
                <div class="metric-caption">Baseline water goal</div>
              </div>
            </div>
          </article>

          <!-- MEAL PLAN CARD -->
          <article class="card">
            <div class="card-header">
              <div>
                <div class="card-tag">Food ¬∑ Today</div>
                <div class="card-title">Example day that matches your goal</div>
              </div>
              <div style="font-size: 0.78rem; opacity: 0.7;">
                Swap foods, keep structure
              </div>
            </div>
            <p class="card-sub" id="meal-subtitle">
              Focus on timing and protein first. You can plug in your own
              cultural foods, brands, and snacks ‚Äî your coach will adapt.
            </p>

            <ul class="meal-list" id="meal-list">
              <!-- JS fills meals -->
            </ul>
          </article>

          <!-- TRAINING CARD -->
          <article class="card">
            <div class="card-header">
              <div>
                <div class="card-tag">Training ¬∑ This week</div>
                <div class="card-title" id="training-title">
                  Training focus matched to your energy.
                </div>
              </div>
              <div style="font-size: 0.78rem; opacity: 0.7;">
                5‚Äì7 day snapshot
              </div>
            </div>
            <p class="card-sub" id="training-subtitle">
              This is a sample template ‚Äî not your forever program. Expect
              short, focused sessions stacked around your highest-energy days.
            </p>

            <div id="training-plan">
              <!-- JS fills training plan -->
            </div>
          </article>
        </div>

        <!-- RIGHT: SUMMARY / COACH NOTES -->
        <aside>
          <!-- PROFILE CARD -->
          <article class="card">
            <div class="card-header">
              <div>
                <div class="card-tag">You</div>
                <div class="card-title">Snapshot from your assessment</div>
              </div>
            </div>
            <ul class="profile-list" id="profile-list">
              <!-- JS fills profile summary -->
            </ul>
          </article>

          <!-- COACH NOTE CARD -->
          <article class="card">
            <div class="card-header">
              <div>
                <div class="card-tag">Coach note</div>
                <div class="card-title" id="coach-title">
                  What actually matters this week.
                </div>
              </div>
            </div>

            <div class="coach-note-text" id="coach-note">
              The fastest progress doesn‚Äôt come from ‚Äúperfect‚Äù days ‚Äî it comes
              from boring consistency. Hit your protein, drink your water,
              and show up to the sessions you planned.
            </div>

            <div class="coach-note-highlight" id="coach-highlight">
              Non-negotiables: 3+ days of movement, 1‚Äì2L of water before noon,
              and one small win stacked onto your toughest day of the week.
            </div>
          </article>

          <!-- COMING SOON CARD -->
          <article class="card">
            <div class="mini-label">Coming soon</div>
            <div class="card-title" style="margin-bottom: 4px;">
              Live AI coach + trend graphs
            </div>
            <p class="card-sub">
              Soon you‚Äôll see your sleep, training, and nutrition trends here ‚Äî
              with NutriMind nudging you before you fall off track.
            </p>
            <div class="coming-soon">
              ¬∑ Connect wearables  
              ¬∑ Export PDF reports for coaches or doctors  
              ¬∑ Smart check-ins that adjust your plan automatically
            </div>
          </article>
        </aside>
      </section>
    </div>
  </main>

  <script>
    // Pull profile data from assessment
    let profile = {};
    try {
      const raw = localStorage.getItem("nutrimindProfile");
      profile = raw ? JSON.parse(raw) : {};
    } catch (e) {
      profile = {};
    }

    // Helpers
    function mapPersona(code) {
      const map = {
        teen_athlete: "Teen / student athlete",
        busy_parent: "Busy parent",
        working_pro: "Working professional",
        college_student: "College / uni student",
        other: "Custom setup",
      };
      return map[code] || "Not specified";
    }

    function mapGoal(code) {
      const map = {
        weight_loss: "Lose body fat",
        muscle_gain: "Build muscle",
        recomp: "Get toned / recomposition",
        performance: "Performance for sport",
        health: "General health & consistency",
      };
      return map[code] || "Not specified";
    }

    function mapActivity(code) {
      const map = {
        sedentary: "Mostly sitting",
        light: "Lightly active",
        active: "Active 3‚Äì4x / week",
        very_active: "Very active most days",
      };
      return map[code] || "Not specified";
    }

    function mapSleep(code) {
      const map = {
        under6: "Under 6 hours",
        6to8: "Around 6‚Äì8 hours",
        over8: "8+ hours",
      };
      return map[code] || "Not specified";
    }

    function mapFood(code) {
      const map = {
        simple: "Simple meals",
        cultural: "Cultural / family foods",
        high_protein: "High-protein focus",
        plant: "Mostly plant-based",
      };
      return map[code] || "Not specified";
    }

    function mapBudget(code) {
      const map = {
        tight: "Tight budget",
        moderate: "Moderate budget",
        flexible: "Flexible budget",
      };
      return map[code] || "Not specified";
    }

    function mapSex(code) {
      const map = {
        male: "Male",
        female: "Female",
        other: "Prefer not to say / other",
      };
      return map[code] || "Not specified";
    }

    // Basic est. calories & macros
    function computeTargets(p) {
      const weight = Number(p.weight) || 68;  // default 68kg
      const height = Number(p.height) || 172; // default 172cm
      const age = Number(p.age) || 18;
      const sex = p.sex || "male";
      const activity = p.activity || "active"; // default

      // Mifflin-St Jeor-ish
      let bmr;
      if (sex === "female") {
        bmr = 10 * weight + 6.25 * height - 5 * age - 161;
      } else {
        bmr = 10 * weight + 6.25 * height - 5 * age + 5;
      }

      const activityFactorMap = {
        sedentary: 1.25,
        light: 1.4,
        active: 1.6,
        very_active: 1.8,
      };
      const activityFactor = activityFactorMap[activity] || 1.6;
      let tdee = bmr * activityFactor;

      const goal = p.goal || "recomp";
      if (goal === "weight